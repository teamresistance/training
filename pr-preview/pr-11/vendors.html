<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Making Use of Vendor Features</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<header class="site-header">
    <a href="index.html" class="site-logo">
        <div class="logo-circle">86</div>
        <div class="logo-text">
            <span class="team-name">Programming Training</span>
            <span class="team-tagline">Going against the current</span>
        </div>
    </a>

    <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">☰</button>
</header>

<nav class="sidebar-nav" id="sidebarNav">
    <div class="nav-section">
        <a href="index.html">Home</a>
        <br>

        <div class="nav-section-title">Quick Reference</div>
        <ul>
            <li><a href="pid-tuning.html">Tuning PID</a></li>
            <li><a href="abstract-io.html">Subsystem IO Abstraction</a></li>
            <li><a href="pathfinding.html">Pathing</a></li>
            <li><a href="standards.html">Code Standards</a></li>
            <li><a href="swerve.html">Swerve Drive</a></li>
        </ul>
    </div>

    <div class="nav-section">
        <div class="nav-section-title">External</div>
        <ul>
            <li><a href="https://docs.wpilib.org/" target="_blank">WPILib Docs ↗</a></li>
            <li><a href="https://www.thebluealliance.com/" target="_blank">The Blue Alliance ↗</a></li>
            <li><a href="https://docs.advantagekit.org/" target="_blank">AdvantageKit ↗</a></li>
        </ul>
    </div>
</nav>
<main class="main-content">
    <div class="content-wrapper">
        <h1>Making Use of Vendor Features</h1>
        <p>
            Modern FRC motor controllers are not dumb speed controllers. TalonFXs and Spark MAXes
            contain onboard sensors, PID loops, motion profiling, current limiting, and safety logic.
            This page documents how those features actually work, when to use them, and how to configure
            them correctly in real robots.
        </p>

        <section>
            <h3>Why Use Onboard Vendor Control?</h3>
            <p>
                Vendor-side control runs directly on the motor controller, at a significantly higher frequency instead of the
                roboRIO’s 50 Hz loop. This gives:
            </p>
            <ul>
                <li>Lower latency and smoother motion</li>
                <li>Better handling of battery usage and CAN bandwidth usage</li>
                <li>Less complex code, as the motor controller firmware actually does stuff with your configuration</li>
            </ul>
        </section>

        <section>
            <h3>TalonFX Integrated PID (Kraken x60/x44)</h3>
            <p>
                TalonFX-powered motors (krakens) contain an internal PID controller that can close the
                loop on position, velocity, or motion profiles using the built-in encoder.
            </p>

            <h4>What Runs on the Motor</h4>
            <ul>
                <li>Normal PID loop (P, I, D)</li>
                <li>Feedforward (kS, kV, kA, kG)</li>
                <li>Motion profiling (Motion Magic!!)</li>
                <li>Current limiting</li>
            </ul>

            <p>
                When you call <code>setControl()</code>, the roboRIO sends a target, not raw motor power.
                The TalonFX then handles the control loop internally.
            </p>
        </section>

        <section>
            <h4>Motion Magic (Kraken x60/x44)</h4>
            <p>
                Motion Magic is CTRE’s trapezoidal motion profiler built into the motor controller.
                You provide a target position, max velocity, and max acceleration.
            </p>

            <h4>How It Works</h4>
            <ol>
                <li>The TalonFX generates a velocity profile internally</li>
                <li>Velocity is fed into the PID + feedforward loop</li>
                <li>The motor smoothly accelerates, cruises, and decelerates</li>
            </ol>

            <p>
                This removes the need to write your own profiling code on the RIO and ensures motion
                stays smooth even during slowdowns caused by CAN overuse, code running slow, roboRIO issues, etc.
			</p>
			<p>
				MotionMagic can be skipped for most cases (for normal positional control), but it can be useful in scenarios where you want to accelerate smoothly and avoid jerk, such as in long arms, light elevators, mechanisms with high backlash, etc.
			</p>
            </ul>
        </section>

        <section>
            <h3>Spark MAX Integrated PID (NEO, Vortex, 550)</h3>
            <p>
                Spark MAX controllers include an onboard PID controller that works with either the
                NEO’s internal encoder or an external encoder. Basically the same as the TalonFX.
            </p>

            <h4>Control Modes</h4>
            <ul>
                <li>Velocity control</li>
                <li>Position control</li>
                <li>Smart Motion / MAXMotion</li>
            </ul>

            <p>
                Like CTRE, once configured, the Spark MAX executes the control loop without relying
                on the roboRIO timing.
            </p>
        </section>

        <section>
            <h4>MAXMotion Position Control</h4>
            <p>
                MAXMotion is REV’s equivalent to Motion Magic. It combines position PID with motion
                constraints to generate smooth movement profiles.
            </p>

            <h4>What You Configure</h4>
            <ul>
                <li>Maximum velocity</li>
                <li>Maximum acceleration</li>
                <li>Allowed closed-loop error</li>
            </ul>

            <p>
                The Spark MAX handles the ramping internally, preventing aggressive starts and stops
                that damage gearboxes or trip breakers.
            </p>
        </section>

        <section>
            <h2>Vendor Configuration / Control Programs</h2>

            <h3>CTRE Tuner X</h3>
            <p>
                Tuner X is used to configure CTRE devices such as TalonFXs, Pidgeon2s (CTRE gyroscope), CANdles (LED controller), and more. It is used to:
            </p>
            <ul>
				<li>Firmware updates (SHOULD BE DONE REGULARLY!!)</li>
                <li>Set CAN IDs (needs to be done to new devices, especially when first starting to put code on the robot)</li>
                <li>Calibrate encoders</li>
                <li>Live-tune PID and feedforward</li>
                <li>Verify sensor direction and motor inversion</li>
				<li>Manually control and configure devices instead of re-deploying code with new values every time</li>
            </ul>

            <p>
                Often times it's faster to use Tuner X to quickly test new PID control, current limits, or other configuration instead of updating your code and redeploying.
            </p>

            <h3>REV Hardware Client</h3>
            <p>
                The REV Hardware Client is used to configure REV devices, primarily SparkMAX controllers. Tuner X and REV client are very similar in use, just for different vendors. It provides:
            </p>
            <ul>
                <li>Firmware updates (SHOULD BE DONE REGULARLY!!)</li>
                <li>Set CAN IDs (needs to be done to new devices, especially when first starting to put code on the robot)</li>
                <li>Calibrate encoders</li>
                <li>Live-tune PID and feedforward</li>
                <li>Verify sensor direction and motor inversion</li>
				<li>Manually control and configure devices instead of re-deploying code with new values every time</li>
            </ul>
        </section>

        <section>
            <h3>Best Practices</h3>
            <ul>
                <li>Always set current and speed limits before enabling closed-loop control, over time sending 60 amps to a motor (even for a split second) can damage it.</li>
                <li>Configure the basics before testing anything control-wise</li>
                <li>Log errors and faults during testing</li>
				<li>Please, try to simulate your code before putting it on a robot unless its heavily based on factors that only exist in the real world</li>
				<li>Try to view data as it is being tested using one of these tools if not AdvantageScope. More data means more things to make better!</li>
            </ul>
        </section>

        <section>
            <h3>Summary</h3>
            <p>
                Vendor motor controllers provide powerful features that dramatically simplify robot
                code when used correctly. Understanding what runs on the controller versus the RIO
                is essential for building reliable, high-performance mechanisms.
            </p>
        </section>
    </div>
</main>

<footer class="site-footer">
    <p>Team Resistance - Going against the current</p>
</footer>

<script>
    function toggleMobileMenu() {
        const sidebar = document.getElementById('sidebarNav');
        sidebar.classList.toggle('active');
    }

    document.addEventListener('click', function(event) {
        const sidebar = document.getElementById('sidebarNav');
        const toggle = document.querySelector('.mobile-menu-toggle');

        if (window.innerWidth <= 1024 &&
            !sidebar.contains(event.target) &&
            !toggle.contains(event.target) &&
            sidebar.classList.contains('active')) {
            sidebar.classList.remove('active');
        }
    });
</script>
</body>
</html>
